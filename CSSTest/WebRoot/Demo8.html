<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>表单Demo</title>
<style type="text/css">
.outer {
	position: absolute;
	display: table;
	width: 500px;
	height: 200px;
	/*border: 1px solid;*/
	left: 50%;
	top: 50%;
	margin-left: -250px;
	margin-top: -100px;
	text-align: center;
}

.inner {
	display: table-cell;
	vertical-align: middle;
}

.tip {
	display: table-cell;
	text-align: right;
	vertical-align: middle;
	/*border:1px solid #f00;*/
}

.input {
	display: table-cell;
	vertical-align: middle;
	text-align: center;
}

.row {
	display: table-row;
	text-align: center;
}

.err {
	color: #f00;
	background-color: #ff0;
	visibility: hidden;
}
</style>
<script type="text/javascript" src="xml.js"></script>
<script type="text/javascript">
	function checkForm() {
		clearerr();
		return checkEmail() && checkUsername() && checkPass() && checkRepass();
	}

	function showerr(errSpan, errMsg) {
		errSpan.innerHTML = errMsg;
		errSpan.style.visibility = "visible";
	}
	function clearerr() {
		var errSpans = document.getElementsByTagName("span");
		for (var i = 0; i < errSpans.length; i++) {
			errSpans[i].style.visibility = "hidden";
		}
	}

	function checkEmail() {
		var email = document.getElementById("email").value;
		var email_msg = document.getElementById("email_msg")
		if (email.length == 0) {
			showerr(email_msg, "邮箱不能为空");
			return false;
		}

		var emailReg = /^(\w)+@(\w)+(\.\w+)+$/;
		if (!emailReg.test(email)) {
			showerr(email_msg, "邮箱格式不正确");
			return false;
		}

		return true;
	}

	function checkUsername() {
		var username = document.getElementById("username").value;
		var username_msg = document.getElementById("username_msg");
		if (username.length == 0) {
			showerr(username_msg, "用户名不能为空");
			return false;
		}
		if (username.length < 6) {
			showerr(username_msg, "用户名长度不能小于6");
			return false;
		}

		return true;

	}

	function checkPass() {
		var pass = document.getElementById("password").value;
		var pass_msg = document.getElementById("password_msg");
		if (pass.length == 0) {
			showerr(pass_msg, "密码不能为空");
			return false;
		}
		if (pass.length < 6) {
			showerr(pass_msg, "密码不能低于6位");
			return false;
		}
		return true;
	}

	function checkRepass() {
		var pass = document.getElementById("password").value;
		var repass = document.getElementById("repassword").value;
		var repass_msg = document.getElementById("repassword_msg");
		if (repass.length == 0) {
			showerr(repass_msg, "请再输入一次密码");
			return false;
		}
		if (repass != pass) {
			showerr(repass_msg, "两次输入的密码不一致");
			return false;
		}
		return true;

	}


	var doc;
	window.onload = function() {
		var provinceElement = document.getElementById("province");
		doc = loadXML("source.xml");
		var ps = doc.getElementsByTagName("province");
		for (var i = 0; i < ps.length; i++) {
			var pname = ps[i].getAttribute("name");
			var op = document.createElement("option");
			op.text = pname;
			provinceElement.add(op);
		}

	};
	function fun() {
		var provinceElement = document.getElementById("province");
		var cityElement = document.getElementById("city");
		cityElement.innerHTML = "<option>--请选择城市--</option>";
		var pname = provinceElement.options[provinceElement.selectedIndex].text;
		var ps = doc.getElementsByTagName("province");
		for (var i = 0; i < ps.length; i++) {
			var provinceName = ps[i].getAttribute("name");
			if (pname == provinceName) {
				var cities = ps[i].childNodes;
				for (var j = 0; j < cities.length; j++) {
					if (cities[j].nodeType == 1) {
						var cname = cities[j].firstChild.nodeValue;
						var op = document.createElement("option");
						op.text = cname;
						cityElement.add(op);
					}
				}
			}
		}
	}
</script>
</head>
<body>

	<div class="outer">
		<div class="inner">
			<div style="font-family: '微软雅黑';font-size: 30px;font-weight: bold;color: #f00;display: cell-row">注册用户</div>
			<div style="display: cell-row;text-align: center">
				<form action="#" method="post" onsubmit="return checkForm();">
					邮箱&nbsp;
					<input type="text" id="email" name="email" onblur="checkEmail();">
					<span id="email_msg" class="err"></span><br>
					用户名&nbsp;
					<input type="text" id="username" name="username" onblur="checkUsername();">
					<span id="username_msg" class="err"></span><br>
					密码&nbsp;<input type="password" id="password" name="password" onblur="checkPass();">
					<span id="password_msg" class="err"></span><br> 
					确认密码&nbsp;<input type="password" id="repassword" onblur="checkRepass();">
					<span id="repassword_msg" class="err"></span><br> 
					所在地&nbsp;<select id="province" onchange="fun();">
					<option>---请选择省份---</option></select>
					<select id="city"></select> <br> 
					<input type="submit" value="注册">
				</form>
			</div>
		</div>
	</div>

</body>
</html>